<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salary Planner</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background: #f4f6f9;
      color: #2c3e50;
      transition: background 0.3s, color 0.3s;
    }
    body.dark {
      background: #1e272e;
      color: #f1f2f6;
    }
    header {
      background: #3498db;
      color: white;
      padding: 15px 20px;
      font-size: 1.3rem;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    header span {
      margin-bottom: 10px;
    }
    header button {
      background: rgba(255,255,255,0.2);
      border: none;
      padding: 8px 14px;
      border-radius: 20px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }
    header button:hover {
      background: rgba(255,255,255,0.35);
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 15px;
    }
    .input-card {
      background: #fff;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      text-align: center;
      margin-bottom: 20px;
      transition: background 0.3s;
    }
    body.dark .input-card { background: #2f3640; }
    .input-card input {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      width: 100%;
      max-width: 250px;
      font-size: 1rem;
      background: inherit;
      color: inherit;
    }
    .accordion-item {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      margin-bottom: 10px;
      overflow: hidden;
      transition: background 0.3s;
    }
    body.dark .accordion-item { background: #2f3640; }
    .accordion-header {
      padding: 15px;
      font-weight: 600;
      background: #ecf0f1;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.3s;
    }
    body.dark .accordion-header { background: #353b48; }
    .accordion-header:hover {
      background: #dfe6e9;
    }
    body.dark .accordion-header:hover { background: #414b57; }
    .accordion-content {
      display: none;
      padding: 10px 10px;
      animation: fadeIn 0.3s ease;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      min-width: 500px;
    }
    th, td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      text-align: center;
      font-size: 0.9rem;
    }
    body.dark th, body.dark td { border-color: #444; }
    th {
      background: #3498db;
      color: #fff;
      font-weight: 600;
    }
    .summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .card {
      background: #fff;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      text-align: center;
      transition: background 0.3s;
      font-size: 0.95rem;
    }
    body.dark .card { background: #2f3640; }
    .status {
      margin-top: 8px;
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      display: inline-block;
      font-size: 0.85rem;
    }
    .status.green { background: #2ecc71; color: #fff; }
    .status.orange { background: #f39c12; color: #fff; }
    .status.red { background: #e74c3c; color: #fff; }
    .charts {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    @media(min-width: 768px) {
      .charts { grid-template-columns: 1fr 1fr; }
    }
    canvas {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      padding: 10px;
      transition: background 0.3s;
      width: 100% !important;
      height: auto !important;
    }
    body.dark canvas { background: #2f3640; }
  </style>
</head>
<body>
  <header>
    <span>ðŸ’° Salary Planner ðŸ’°</span>
    <button onclick="toggleDarkMode()">ðŸŒ™ Dark Mode</button>
  </header>
  <div class="container">
    <div class="input-card">
      <label for="salary">Enter Salary:</label><br>
      <input type="number" id="salary" value="50000" oninput="calculate()">
    </div>

    <div id="accordion" class="accordion"></div>

    <div class="summary">
      <div class="card"><b>Total Salary</b><br>â‚¹<span id="sumSalary">0</span></div>
      <div class="card"><b>Suggested Allocation</b><br>â‚¹<span id="sumSuggested">0</span></div>
      <div class="card"><b>Actual Spending</b><br>â‚¹<span id="sumActual">0</span></div>
      <div class="card"><b>Remaining / Surplus</b><br>â‚¹<span id="sumRemaining">0</span><br><span id="verdict" class="status"></span></div>
    </div>

    <div class="charts">
      <div>
        <h3 style="text-align:center;">Suggested Allocation</h3>
        <canvas id="suggestedChart"></canvas>
      </div>
      <div>
        <h3 style="text-align:center;">Actual Spending</h3>
        <canvas id="actualChart"></canvas>
      </div>
    </div>
  </div>

  <script>
    const categories = {
      "Essential Expenses": {
        "Rent/EMI": 0.20,
        "Food & Groceries": 0.14,
        "Utilities (Bills, Transport)": 0.08,
        "Insurance Premiums": 0.08,
      },
      "Investments & Savings": {
        "Emergency Fund": 0.10,
        "Equity Mutual Funds": 0.12,
        "Retirement (PPF/NPS)": 0.04,
        "Gold/REITs": 0.04,
      },
      "Lifestyle & Personal Growth": {
        "Entertainment/Dining": 0.08,
        "Travel/Shopping": 0.06,
        "Courses/Skills": 0.06,
      }
    };

    let suggestedChart, actualChart;

    function calculate() {
      const salary = parseFloat(document.getElementById("salary").value) || 0;
      const accordion = document.getElementById("accordion");
      accordion.innerHTML = "";

      let grandSuggested = 0;
      const categorySuggested = {};
      const categoryActual = {};

      for (const [cat, subs] of Object.entries(categories)) {
        let catSuggestedTotal = 0;

        const accItem = document.createElement("div");
        accItem.className = "accordion-item";

        const header = document.createElement("div");
        header.className = "accordion-header";
        header.textContent = cat;
        header.onclick = () => {
          content.style.display = content.style.display === "block" ? "none" : "block";
        };

        const content = document.createElement("div");
        content.className = "accordion-content";

        const table = document.createElement("table");
        table.innerHTML = `
          <thead>
            <tr>
              <th>Sub-Category</th>
              <th>Suggested %</th>
              <th>Suggested Amount</th>
              <th>Your Actual</th>
              <th>Difference</th>
            </tr>
          </thead>
          <tbody></tbody>
        `;

        const tbody = table.querySelector("tbody");

        for (const [sub, pct] of Object.entries(subs)) {
          const row = document.createElement("tr");
          const suggestedAmount = salary * pct;
          catSuggestedTotal += suggestedAmount;
          grandSuggested += suggestedAmount;
          row.innerHTML = `
            <td>${sub}</td>
            <td>${(pct*100).toFixed(0)}%</td>
            <td>â‚¹${suggestedAmount.toFixed(0)}</td>
            <td><input type="number" oninput="updateSummary()" style="width:100%; max-width:120px; padding:5px; border-radius:6px; border:1px solid #ccc;"></td>
            <td>â‚¹${suggestedAmount.toFixed(0)}</td>
          `;
          tbody.appendChild(row);
        }

        content.appendChild(table);
        accItem.appendChild(header);
        accItem.appendChild(content);
        accordion.appendChild(accItem);

        categorySuggested[cat] = catSuggestedTotal;
        categoryActual[cat] = 0;
      }

      document.getElementById("sumSalary").textContent = salary.toFixed(0);
      document.getElementById("sumSuggested").textContent = grandSuggested.toFixed(0);

      const ctxSuggested = document.getElementById('suggestedChart').getContext('2d');
      const ctxActual = document.getElementById('actualChart').getContext('2d');

      if (suggestedChart) suggestedChart.destroy();
      if (actualChart) actualChart.destroy();

      suggestedChart = new Chart(ctxSuggested, {
        type: 'doughnut',
        data: {
          labels: Object.keys(categorySuggested),
          datasets: [{
            data: Object.values(categorySuggested),
            backgroundColor: ['#3498db','#2ecc71','#f1c40f'],
          }]
        },
        options: { responsive: true, maintainAspectRatio: false }
      });

      actualChart = new Chart(ctxActual, {
        type: 'doughnut',
        data: {
          labels: Object.keys(categoryActual),
          datasets: [{
            data: Object.values(categoryActual),
            backgroundColor: ['#3498db','#2ecc71','#f1c40f'],
          }]
        },
        options: { responsive: true, maintainAspectRatio: false }
      });

      updateSummary();
    }

    function updateSummary() {
      const salary = parseFloat(document.getElementById("salary").value) || 0;
      const rows = document.querySelectorAll("tbody tr");
      const categoryActual = { "Essential Expenses":0, "Investments & Savings":0, "Lifestyle & Personal Growth":0};
      let totalActual = 0;

      rows.forEach(row => {
        const subInput = row.querySelector("input");
        if(subInput){
          const actual = parseFloat(subInput.value) || 0;
          const suggested = parseFloat(row.cells[2].textContent.replace("â‚¹","")) || 0;
          row.cells[4].textContent = "â‚¹" + (suggested - actual).toFixed(0);
          totalActual += actual;
          let catName = row.closest(".accordion-item").querySelector(".accordion-header").textContent;
          categoryActual[catName] += actual;
        }
      });

      document.getElementById("sumActual").textContent = totalActual.toFixed(0);
      const remaining = salary - totalActual;
      document.getElementById("sumRemaining").textContent = remaining.toFixed(0);

      const verdict = document.getElementById("verdict");
      verdict.className = "status";
      if (remaining > salary * 0.1) {
        verdict.textContent = "Saving Well";
        verdict.classList.add("green");
      } else if (remaining >= 0) {
        verdict.textContent = "Close to Overspending";
        verdict.classList.add("orange");
      } else {
        verdict.textContent = "Overspending!";
        verdict.classList.add("red");
      }

      actualChart.data.datasets[0].data = Object.values(categoryActual);
      actualChart.update();
    }

    function toggleDarkMode(){
      document.body.classList.toggle("dark");
    }

    calculate();
  </script>
</body>
</html>
